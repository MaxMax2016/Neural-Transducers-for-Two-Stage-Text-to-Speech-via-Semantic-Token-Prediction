A code version with reference to valle and k2 code
